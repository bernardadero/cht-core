<?xml version="1.0"?>
<h:html xmlns="http://www.w3.org/2002/xforms" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:jr="http://openrosa.org/javarosa" xmlns:orx="http://openrosa.org/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <h:head>
    <h:title>Contact follow-up</h:title>
    <model>
      <itext>
        <translation lang="en">
          <text id="/contact_follow_up/group_follow_up/follow_up_type/in_person:label">
            <value>Physical</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/follow_up_type/phone:label">
            <value>Phone</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_call/call_not_going_through:label">
            <value>Calls not going through</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_call/died:label">
            <value>Died</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_call/incorrect_locator_info:label">
            <value>Incorrect locator information</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_call/no_call_locator_info:label">
            <value>No locator information</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_call/other:label">
            <value>Other</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_call/responded:label">
            <value>Contacted and already on ART</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_call/responded_not_linked:label">
            <value>Contacted</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_visit/available:label">
            <value>Contacted and already on ART</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_visit/available_not_linked:label">
            <value>Contacted</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_visit/died:label">
            <value>Died</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_visit/moved_away:label">
            <value>Migrated</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_visit/no_locator_information:label">
            <value>No locator information</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_visit/not_found_at_home:label">
            <value>Person not found at home</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_visit/other:label">
            <value>Other</value>
          </text>
          <text id="/contact_follow_up/group_follow_up/status_visit/wrong_locator_information:label">
            <value>Incorrect locator information</value>
          </text>
        </translation>
      </itext>
      <instance>
        <contact_follow_up delimiter="#" id="contact_follow_up" prefix="J1!contact_follow_up!" version="2020-08-26">
          <inputs>
            <meta>
              <location>
                <lat/>
                <long/>
                <error/>
                <message/>
              </location>
            </meta>
            <user>
              <contact_id/>
              <facility_id/>
              <username/>
            </user>
            <source>user</source>
            <source_id/>
            <t_follow_up_count/>
            <form_uuid/>
            <encounter_type_uuid/>
            <encounterDate/>
            <contact>
              <_id/>
              <type/>
              <contact_type/>
              <role/>
              <s_name/>
              <f_name/>
              <o_name/>
              <name/>
              <sex/>
              <dob_known/>
              <date_of_birth/>
              <marital_status/>
              <nationality/>
              <phone/>
              <alternate_phone/>
              <postal_address/>
              <email_address/>
              <county/>
              <subcounty/>
              <ward/>
              <location/>
              <sub_location/>
              <village/>
              <landmark/>
              <residence/>
              <nearest_health_center/>
              <kin_name/>
              <kin_relationship/>
              <kin_phone_number/>
              <kin_postal_address/>
              <type_of_exposure/>
              <parent/>
            </contact>
          </inputs>
          <patient_uuid/>
          <patient_age_in_years/>
          <patient_age_in_months/>
          <patient_age_display/>
          <last_contact_date/>
          <needs_signoff>true</needs_signoff>
          <group_follow_up>
            <follow_up_type/>
            <call_button/>
            <no_phone/>
            <status_call/>
            <status_call_other/>
            <status_visit/>
            <status_visit_other/>
            <facility_linked_to/>
            <unique_patient_number/>
            <n_remarks/>
            <remarks/>
            <n_remarks_delimiter/>
            <is_not_available_reason_other/>
          </group_follow_up>
          <audit_trail>
            <created_by/>
          </audit_trail>
          <patient_name/>
          <meta tag="hidden">
            <instanceID/>
          </meta>
        </contact_follow_up>
      </instance>
      <instance id="contact-summary"/>
      <bind nodeset="/contact_follow_up/inputs" relevant="./source = 'user'"/>
      <bind nodeset="/contact_follow_up/inputs/user/contact_id" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/user/facility_id" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/user/username" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/source" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/source_id" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/t_follow_up_count" type="string"/>
      <bind calculate="15ed03d2-c972-11e9-a32f-2a2ae2dbcce4'" nodeset="/contact_follow_up/inputs/form_uuid" type="string"/>
      <bind calculate="'9c0a7a57-62ff-4f75-babe-5835b0e921b7'" nodeset="/contact_follow_up/inputs/encounter_type_uuid" type="string"/>
      <bind constraint="floor(decimal-date-time(.)) &lt;= floor(decimal-date-time(today())) and floor( difference-in-months( . , today() ) div 12 ) &lt;= 100" jr:constraintMsg="Encounter date can not be in the future" nodeset="/contact_follow_up/inputs/encounterDate" required="true()" type="date"/>
      <bind nodeset="/contact_follow_up/inputs/contact/_id" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/type" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/contact_type" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/role" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/s_name" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/f_name" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/o_name" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/name" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/sex" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/dob_known" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/date_of_birth" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/marital_status" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/nationality" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/phone" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/alternate_phone" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/postal_address" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/email_address" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/county" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/subcounty" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/ward" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/location" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/sub_location" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/village" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/landmark" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/residence" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/nearest_health_center" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/kin_name" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/kin_relationship" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/kin_phone_number" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/kin_postal_address" type="string"/>
      <bind nodeset="/contact_follow_up/inputs/contact/type_of_exposure" type="string"/>
      <bind calculate="../inputs/contact/_id" nodeset="/contact_follow_up/patient_uuid" type="string"/>
      <bind calculate="floor( difference-in-months(  /contact_follow_up/inputs/contact/date_of_birth , today() ) div 12 )" nodeset="/contact_follow_up/patient_age_in_years" type="string"/>
      <bind calculate="difference-in-months(  /contact_follow_up/inputs/contact/date_of_birth , today() )" nodeset="/contact_follow_up/patient_age_in_months" type="string"/>
      <bind calculate="concat(
 concat( /contact_follow_up/patient_age_in_years , if( /contact_follow_up/patient_age_in_years =1,' year and ',' years and ')),
 concat( /contact_follow_up/patient_age_in_months  mod 12, if(( /contact_follow_up/patient_age_in_months  mod 12)=1,' month old',' months old'))
)" nodeset="/contact_follow_up/patient_age_display" type="string"/>
      <bind calculate="2020-08-26" nodeset="/contact_follow_up/last_contact_date" type="string"/>
      <bind nodeset="/contact_follow_up/needs_signoff" type="string"/>
      <bind constraint="not(selected(.,'phone') and  /contact_follow_up/inputs/contact/phone  = '')" jr:constraintMsg="There's no registered phone number" nodeset="/contact_follow_up/group_follow_up/follow_up_type" required="true()" type="select1"/>
      <bind nodeset="/contact_follow_up/group_follow_up/call_button" readonly="true()" relevant=" /contact_follow_up/group_follow_up/follow_up_type ='phone' and  /contact_follow_up/inputs/contact/phone !=''" type="string"/>
      <bind nodeset="/contact_follow_up/group_follow_up/no_phone" readonly="true()" relevant=" /contact_follow_up/group_follow_up/follow_up_type ='phone' and  /contact_follow_up/inputs/contact/phone =''" type="string"/>
      <bind nodeset="/contact_follow_up/group_follow_up/status_call" relevant=" /contact_follow_up/group_follow_up/follow_up_type ='phone' and  /contact_follow_up/inputs/contact/phone !=''" required="true()" type="select1"/>
      <bind nodeset="/contact_follow_up/group_follow_up/status_call_other" relevant=" /contact_follow_up/group_follow_up/status_call  = 'other'" required="true()" type="string"/>
      <bind nodeset="/contact_follow_up/group_follow_up/status_visit" relevant=" /contact_follow_up/group_follow_up/follow_up_type  = 'in_person'" required="true()" type="select1"/>
      <bind nodeset="/contact_follow_up/group_follow_up/status_visit_other" relevant=" /contact_follow_up/group_follow_up/status_visit  = 'other'" required="true()" type="string"/>
      <bind nodeset="/contact_follow_up/group_follow_up/facility_linked_to" relevant=" /contact_follow_up/group_follow_up/status_call  = 'responded' or  /contact_follow_up/group_follow_up/status_visit = 'available'" required="true()" type="string"/>
      <bind nodeset="/contact_follow_up/group_follow_up/unique_patient_number" relevant=" /contact_follow_up/group_follow_up/status_call  = 'responded' or  /contact_follow_up/group_follow_up/status_visit = 'available'" required="true()" type="string"/>
      <bind nodeset="/contact_follow_up/group_follow_up/n_remarks" readonly="true()" type="string"/>
      <bind nodeset="/contact_follow_up/group_follow_up/remarks" type="string"/>
      <bind nodeset="/contact_follow_up/group_follow_up/n_remarks_delimiter" readonly="true()" type="string"/>
      <bind nodeset="/contact_follow_up/group_follow_up/is_not_available_reason_other" type="string"/>
      <bind calculate="../inputs/user/username" nodeset="/contact_follow_up/audit_trail/created_by" type="string"/>
      <bind calculate="../inputs/contact/name" nodeset="/contact_follow_up/patient_name" type="string"/>
      <bind calculate="concat('uuid:', uuid())" nodeset="/contact_follow_up/meta/instanceID" readonly="true()" type="string"/>
    </model>
  </h:head>
  <h:body class="pages">
    <group appearance="field-list" ref="/contact_follow_up/inputs">
      <label>Patient</label>
      <group ref="/contact_follow_up/inputs/user">
        <label></label>
        <input ref="/contact_follow_up/inputs/user/contact_id">
          <label></label>
        </input>
        <input ref="/contact_follow_up/inputs/user/facility_id">
          <label></label>
        </input>
        <input ref="/contact_follow_up/inputs/user/username">
          <label></label>
        </input>
      </group>
      <input ref="/contact_follow_up/inputs/encounterDate">
        <label>Encounter date</label>
      </input>
      <group ref="/contact_follow_up/inputs/contact">
        <label>Contact</label>
        <group ref="/contact_follow_up/inputs/contact/parent"/>
      </group>
    </group>
    <group appearance="field-list" ref="/contact_follow_up/group_follow_up">
      <label>Tracing details</label>
      <select1 ref="/contact_follow_up/group_follow_up/follow_up_type">
        <label>How are you following up?</label>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/follow_up_type/in_person:label')"/>
          <value>in_person</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/follow_up_type/phone:label')"/>
          <value>phone</value>
        </item>
      </select1>
      <input ref="/contact_follow_up/group_follow_up/call_button">
        <label>[&lt;span style='background-color:#F0F4FD; border:1px solid #007AC0; padding: 0.5em; border-radius: 4px; text-decoration:none; display: block; margin-left: auto; margin-right: auto; width: 40%; text-align: center;'&gt;&lt;i class=&quot;fa fa-phone&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&amp;nbsp;Call <output value=" /contact_follow_up/inputs/contact/name "/>&lt;/span&gt;](tel://<output value=" /contact_follow_up/inputs/contact/phone "/>)</label>
      </input>
      <input ref="/contact_follow_up/group_follow_up/no_phone">
        <label><output value=" /contact_follow_up/inputs/contact/name "/> does not have a registered phone number</label>
      </input>
      <select1 ref="/contact_follow_up/group_follow_up/status_call">
        <label>Outcome of call</label>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_call/responded:label')"/>
          <value>responded</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_call/responded_not_linked:label')"/>
          <value>responded_not_linked</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_call/call_not_going_through:label')"/>
          <value>call_not_going_through</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_call/no_call_locator_info:label')"/>
          <value>no_call_locator_info</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_call/incorrect_locator_info:label')"/>
          <value>incorrect_locator_info</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_call/died:label')"/>
          <value>died</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_call/other:label')"/>
          <value>other</value>
        </item>
      </select1>
      <input ref="/contact_follow_up/group_follow_up/status_call_other">
        <label>Please specify</label>
      </input>
      <select1 ref="/contact_follow_up/group_follow_up/status_visit">
        <label>Outcome of visit</label>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_visit/available:label')"/>
          <value>available</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_visit/available_not_linked:label')"/>
          <value>available_not_linked</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_visit/moved_away:label')"/>
          <value>moved_away</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_visit/not_found_at_home:label')"/>
          <value>not_found_at_home</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_visit/no_locator_information:label')"/>
          <value>no_locator_information</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_visit/wrong_locator_information:label')"/>
          <value>wrong_locator_information</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_visit/died:label')"/>
          <value>died</value>
        </item>
        <item>
          <label ref="jr:itext('/contact_follow_up/group_follow_up/status_visit/other:label')"/>
          <value>other</value>
        </item>
      </select1>
      <input ref="/contact_follow_up/group_follow_up/status_visit_other">
        <label>Please specify</label>
      </input>
      <input ref="/contact_follow_up/group_follow_up/facility_linked_to">
        <label>Facility linked to</label>
      </input>
      <input ref="/contact_follow_up/group_follow_up/unique_patient_number">
        <label>Unique Patient No.</label>
      </input>
      <input ref="/contact_follow_up/group_follow_up/n_remarks">
        <label>**&lt;span style="color:blue"&gt;Remarks&lt;/span&gt;**</label>
      </input>
      <input ref="/contact_follow_up/group_follow_up/remarks">
        <label>Remarks</label>
      </input>
      <input ref="/contact_follow_up/group_follow_up/n_remarks_delimiter">
        <label>&lt;hr style="margin:0 auto;"&gt;</label>
      </input>
    </group>
    <group appearance="hidden" ref="/contact_follow_up/audit_trail">
      <label></label>
    </group>
  </h:body>
</h:html>
